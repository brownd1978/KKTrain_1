
# Machine learning training for hit classification in the Mu2eKinKal fit

This repo contains Jupyter workbooks to train the ANNs used in the [Mu2eKinKal](https://github.com/Mu2e/Offline/tree/main/Mu2eKinKal) fits, using
The training uses [Keras](https://keras.io) and pytorch to create _multi layer perceptron_ 

The underlying fit is a kinematic Kalman filter track fit, provided in the [KinKal](https://github.com/KFTrack/KinKal) package.

The first step to run the notebook is to install a kernel that includes support for everything listed in requirements.txt.  For working
on nersc, see https://docs.nersc.gov/services/jupyter/#conda-environments-as-kernels
Then, you can load a particular notebook.  Note that data is stored on NERSC in:
/global/cfs/cdirs/m3712/Mu2e/TrkAna

- TrainBkg.ipynb is used to separate true electron track hits from those generated by background particles
- TrainLRDrift.ipynb is used to separate hits which have accurate drift information, including left-right sign, from hits with either poor drift 
measurement (due to ion cluster effects) or an ambiguous left-right sign.

